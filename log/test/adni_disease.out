nohup: ignoring input
wandb: Currently logged in as: yein-hwang. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in /media/leelabsg-storage1/yein/research/wandb/RegionBAE/wandb/run-20240602_135159-vq6juy0e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gallant-galaxy-293
wandb: ‚≠êÔ∏è View project at https://wandb.ai/yein-hwang/reg_trial
wandb: üöÄ View run at https://wandb.ai/yein-hwang/reg_trial/runs/vq6juy0e
====================  Setting  ====================
Dataset :                  adni_disease
Mode :                     test_tf
Number of gpus :           1
Batch size :              4
Data size:                1177
Epochs :                  40
Learning Rate :           0.0001
Early Stopping Patience : 0
# of Workers  :           16
Region of Interest :      imgs
Model Save Path:          ../../model/region_BAE/pre/adni_disease/imgs/
Loaded Model Epoch:       40
==================================================

<<< StratifiedKFold: 1/4 >>>
Train Dataset & Validation Dataset size:  221 74
[   3    4    9   13   17   20   23   24   25   26   34   38   40   42
   46   53   54   58   60   61   63   70   71   74   75   83   94   95
   97   98   99  101  108  109  110  113  123  125  128  130  132  134
  140  141  146  151  153  164  168  170  171  172  179  186  189  196
  199  204  205  207  216  220  222  224  228  244  252  253  259  262
  263  264  270  278  280  283  284  285  289  305  306  308  316  318
  325  334  336  339  358  361  365  367  372  374  377  379  384  396
  397  399  407  415  422  426  430  432  445  447  449  454  457  463
  466  467  471  473  478  483  484  488  489  493  498  500  503  504
  506  508  509  510  513  518  522  525  528  530  541  544  558  565
  568  571  578  585  587  591  595  597  598  602  603  609  610  611
  619  621  632  633  641  642  653  656  657  662  665  666  669  691
  699  701  702  704  705  718  720  721  724  732  736  743  744  750
  751  755  758  770  777  779  781  782  790  791  794  797  799  802
  804  806  815  816  818  825  828  833  840  841  842  843  845  852
  856  857  861  866  870  878  884  889  892  893  895  901  906  909
  915  916  922  929  930  935  948  951  952  953  957  963  965  966
  967  968  976  983  986 1009 1012 1017 1019 1020 1023 1031 1032 1033
 1035 1037 1039 1042 1047 1048 1050 1051 1054 1061 1065 1070 1071 1072
 1075 1077 1081 1083 1085 1090 1095 1098 1100 1104 1109 1113 1114 1115
 1117 1118 1128 1138 1141 1143 1145 1151 1152 1156 1164 1166 1170 1172
 1176]
============== Loaded model: ../../model/region_BAE/transfer_adni/imgs/cv-0-40.pth.tar
[ Start test ] <torch.utils.data.dataloader.DataLoader object at 0x7f4283c5e080>
  0%|          | 0/295 [00:00<?, ?it/s]  0%|          | 0/295 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/media/leelabsg-storage1/yein/research/BAE/RegionBAE/src/main_cv.py", line 227, in <module>
    pred_ages, true_ages, features = trainer.test() # test
  File "/media/leelabsg-storage1/yein/research/BAE/RegionBAE/src/CNN_Trainer.py", line 190, in test
    for _, (input, target) in enumerate(tqdm(self.dataloader_test)):
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/tqdm/std.py", line 1182, in __iter__
    for obj in iterable:
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/_utils.py", line 694, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/nibabel/loadsave.py", line 100, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/media/leelabsg-storage1/yein/research/data/adni_region/sub-002S0729X20060802/T1w_registered.nii.gz'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/media/leelabsg-storage1/yein/research/BAE/RegionBAE/src/dataset.py", line 118, in __getitem__
    image = nib.load(image_path).get_fdata()
  File "/data/home/yeinhwang/micromamba/envs/vx/lib/python3.10/site-packages/nibabel/loadsave.py", line 102, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/media/leelabsg-storage1/yein/research/data/adni_region/sub-002S0729X20060802/T1w_registered.nii.gz'

wandb: üöÄ View run gallant-galaxy-293 at: https://wandb.ai/yein-hwang/reg_trial/runs/vq6juy0e
wandb: Ô∏è‚ö° View job at https://wandb.ai/yein-hwang/reg_trial/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEzNDc1Mjc4NA==/version_details/v37
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /media/leelabsg-storage1/yein/research/wandb/RegionBAE/wandb/run-20240602_135159-vq6juy0e/logs
